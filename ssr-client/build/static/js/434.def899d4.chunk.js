"use strict";(self.webpackChunkssr_client=self.webpackChunkssr_client||[]).push([[434],{3434:(e,a,s)=>{s.r(a),s.d(a,{default:()=>o});var l=s(9643),n=s(7214),r=s.n(n),t=s(6507);const c=e=>{let{data:a}=e;const s=a.QR_VISITS||0,l=a.DIRECT_VISITS||0,n=[{label:"QR + Direct Visits",value:s+l,breakdown:{qr:s,direct:l}},{label:"Deals Claimed",value:a.DEALS_CLAIMED||0},{label:"Repeat Visits",value:a.REPEAT_VISITS||0}],r=Math.max(...n.map((e=>e.value)));return(0,t.jsx)("div",{className:"funnel",children:n.map(((e,a)=>{const s=r>0?e.value/r*100:0;let l="#4caf50";return s<70&&s>=40&&(l="#fbc02d"),s<40&&(l="#fb8c00"),(0,t.jsxs)("div",{className:"funnel-row",children:[(0,t.jsx)("div",{className:"funnel-bar-wrapper",children:e.breakdown?(0,t.jsxs)("div",{className:"funnel-bar stacked",style:{width:"".concat(s,"%")},children:[(0,t.jsx)("div",{className:"bar-qr",style:{flex:e.breakdown.qr}}),(0,t.jsx)("div",{className:"bar-direct",style:{flex:e.breakdown.direct}})]}):(0,t.jsx)("div",{className:"funnel-bar",style:{width:"".concat(s,"%"),background:l}})}),(0,t.jsxs)("div",{className:"funnel-label",children:[e.label," \u2014 ",(0,t.jsx)("strong",{children:e.value}),e.breakdown&&(0,t.jsxs)("span",{className:"breakdown",children:[" ","(QR: ",e.breakdown.qr,", Direct: ",e.breakdown.direct,")"]})]})]},a)}))})},i=e=>{let{data:a}=e;const s=[{label:"Shares",value:a.SHARES||0},{label:"Share Visits",value:a.SHARE_VISITS||0},{label:"Deals Claimed",value:a.SHARE_DEALS_CLAIMED||0}],l=Math.max(...s.map((e=>e.value)));return(0,t.jsx)("div",{className:"funnel",children:s.map(((e,a)=>{const s=l>0?e.value/l*100:0;let n="#4caf50";return s<70&&s>=40&&(n="#fbc02d"),s<40&&(n="#fb8c00"),(0,t.jsxs)("div",{className:"funnel-row",children:[(0,t.jsx)("div",{className:"funnel-bar-wrapper",children:e.breakdown?(0,t.jsxs)("div",{className:"funnel-bar stacked",style:{width:"".concat(s,"%")},children:[(0,t.jsx)("div",{className:"bar-qr",style:{flex:e.breakdown.qr}}),(0,t.jsx)("div",{className:"bar-direct",style:{flex:e.breakdown.direct}})]}):(0,t.jsx)("div",{className:"funnel-bar",style:{width:"".concat(s,"%"),background:n}})}),(0,t.jsxs)("div",{className:"funnel-label",children:[e.label," \u2014 ",(0,t.jsx)("strong",{children:e.value}),e.breakdown&&(0,t.jsxs)("span",{className:"breakdown",children:[" ","(QR: ",e.breakdown.qr,", Direct: ",e.breakdown.direct,")"]})]})]},a)}))})},d=e=>{let{data:a}=e;const s=a.ENQUIRIES||0,l=a.BASKET_ADD||0,n=s+l,r=[{label:"Store Browse",value:a.STORE_BROWSE||0},{label:"Enquiries + Basket Adds",value:n,breakdown:{enquiries:s,basketAdd:l}},{label:"Re-order",value:a.RE_ORDER||0}],c=Math.max(...r.map((e=>e.value)));return(0,t.jsx)("div",{className:"funnel",children:r.map(((e,a)=>{const s=c>0?e.value/c*100:0;let l="#4caf50";return s<70&&s>=40&&(l="#fbc02d"),s<40&&(l="#fb8c00"),(0,t.jsxs)("div",{className:"funnel-row",children:[(0,t.jsx)("div",{className:"funnel-bar-wrapper",children:e.breakdown?(0,t.jsxs)("div",{className:"funnel-bar stacked",style:{width:"".concat(s,"%")},children:[(0,t.jsx)("div",{className:"bar-qr",style:{flex:e.breakdown.enquiries}}),(0,t.jsx)("div",{className:"bar-direct",style:{flex:e.breakdown.basketAdd}})]}):(0,t.jsx)("div",{className:"funnel-bar",style:{width:"".concat(s,"%"),background:l}})}),(0,t.jsxs)("div",{className:"funnel-label",children:[e.label," \u2014 ",(0,t.jsx)("strong",{children:e.value}),e.breakdown&&(0,t.jsxs)("span",{className:"breakdown",children:[" ","(Enquiries: ",e.breakdown.enquiries,", Basket Adds: ",e.breakdown.basketAdd,")"]})]})]},a)}))})},o=e=>{let{url:a}=e;const[s,n]=(0,l.useState)(0),[o,u]=(0,l.useState)(0),[h,b]=(0,l.useState)(0),[v,f]=(0,l.useState)(0),[x,m]=(0,l.useState)("repeat"),[j,p]=(0,l.useState)("searches"),[S,k]=(0,l.useState)(null),[w,N]=(0,l.useState)(null),[y,g]=(0,l.useState)(null),E=async e=>{"searches"==e&&r().get("/recent-searches").then(function(e){"auth error"!=e.data&&g(e.data)}.bind(void 0)),r().get("/stats/".concat(e,"/15 days")).then(function(e){let a=0;if("auth error"!=e.data){console.log("--res--",JSON.stringify(e.data));let s=0,l=[];e.data.forEach(((e,l)=>{s++,a+=parseInt(e.count,0)})),e.data.forEach(((e,s)=>{console.log("val--",e.count/a);let n={count:Math.round(e.count/a*100)};"undefined"!==typeof e.product_type?n.product_type=e.product_type:n.query=e.query,l.push(n)})),N(l)}}.bind(void 0))},R=async e=>{let a=JSON.parse(window.sessionStorage.getItem("user-profile")).storeId;r().get("/store-stats/".concat(a,"/").concat(e.toUpperCase())).then(function(e){if("auth error"!=e.data){console.log("--res--",JSON.stringify(e.data));const a=e.data.reduce(((e,a)=>(e[a.metric]=Number(a.value),e)),{});k(a),n(a.QR_VISITS),u(a.DIRECT_VISITS),b(a.DEALS_CLAIMED),f(a.REPEAT_VISITS)}}.bind(void 0))};return(0,l.useEffect)((()=>{document.getElementById("notif-tabs");const e=document.querySelectorAll(".notif-tab");e.forEach((a=>{a.addEventListener("click",(()=>{e.forEach((e=>e.classList.remove("active"))),a.classList.add("active")}))})),R("repeat"),E("searches")}),[]),(0,t.jsxs)("div",{className:"main",children:[(0,t.jsxs)("div",{class:"di-container",children:[(0,t.jsx)("h1",{children:"Demand Insights"}),(0,t.jsx)("div",{class:"notif-tabs-container",children:(0,t.jsxs)("div",{class:"notif-tabs",id:"notif-tabs-0",children:[(0,t.jsx)("div",{onClick:()=>{p("searches"),E("searches")},className:"notif-tab ".concat("searches"==j?"active":""),children:"Searches"}),(0,t.jsx)("div",{onClick:()=>{p("favourites"),E("favs")},className:"notif-tab ".concat("favourites"==j?"active":""),children:"Favourites"})]})}),null!=w&&"searches"==j&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"funnel-headline",children:[(0,t.jsx)("span",{style:{marginRight:"8px",fontWeight:"bold",top:"-14px",position:"relative",color:"#616161"},children:"Recent Searches:"}),y&&y.map(((e,a)=>0==a?(0,t.jsx)("span",{style:{top:"-14px",position:"relative",color:"#616161"},children:e.query}):(0,t.jsxs)("span",{style:{top:"-14px",position:"relative",color:"#616161"},children:[", ",e.query]}))),(0,t.jsx)("ul",{class:"cloud",role:"navigation","aria-label":"Webdev word cloud",children:w.map(((e,a)=>(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#","data-weight":e.count,children:e.query})})))})]})}),null!=w&&"favourites"==j&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"funnel-headline",children:(0,t.jsx)("ul",{class:"cloud",role:"navigation","aria-label":"Webdev word cloud",children:w.map(((e,a)=>(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#","data-weight":e.count,children:e.product_type})})))})})})]}),(0,t.jsxs)("div",{class:"stats-container",children:[(0,t.jsx)("h1",{children:"Stats"}),(0,t.jsx)("div",{class:"notif-tabs-container",children:(0,t.jsxs)("div",{class:"notif-tabs",id:"notif-tabs",children:[(0,t.jsx)("div",{onClick:()=>{m("repeat"),R("repeat")},className:"notif-tab ".concat("repeat"==x?"active":""),children:"Repeat"}),(0,t.jsx)("div",{onClick:()=>{m("referral"),R("referral")},className:"notif-tab ".concat("referral"==x?"active":""),children:"Referral"}),(0,t.jsx)("div",{onClick:()=>{m("online"),R("online")},className:"notif-tab ".concat("online"==x?"active":""),children:"Reorder"})]})}),null!=S&&"repeat"==x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"funnel-headline",children:"Repeat visitor funnel:"}),(0,t.jsx)(c,{data:S})]}),null!=S&&"referral"==x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"funnel-headline",children:"Referral visitor funnel:"}),(0,t.jsx)(i,{data:S})]}),null!=S&&"online"==x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"funnel-headline",children:"Online reordering funnel:"}),(0,t.jsx)(d,{data:S})]})]})]})}}}]);
//# sourceMappingURL=434.def899d4.chunk.js.map