{"version":3,"file":"static/js/434.11b083d3.chunk.js","mappings":"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","sources":["store/mainview/stats/Stats.js"],"sourcesContent":["import { useState, createRef, useEffect } from \"react\";\nimport axios from 'axios';\nimport \"./Stats.css\";\n\nconst Funnel = ({ data }) => {\n  const qr = data.QR_VISITS || 0;\n  const direct = data.DIRECT_VISITS || 0;\n  const qrDirect = qr + direct;\n\n  const funnelData = [\n    { label: \"QR + Direct Visits\", value: qrDirect, breakdown: { qr, direct } },\n    { label: \"Deals Claimed\", value: data.DEALS_CLAIMED || 0 },\n    { label: \"Repeat Visits\", value: data.REPEAT_VISITS || 0 },\n  ];\n\n  const maxValue = Math.max(...funnelData.map((d) => d.value));\n\n  return (\n    <div className=\"funnel\">\n      {funnelData.map((step, idx) => {\n        const widthPercent =\n          maxValue > 0 ? (step.value / maxValue) * 100 : 0;\n\n        return (\n          <div key={idx} className=\"funnel-row\">\n            <div className=\"funnel-bar-wrapper\">\n              {step.breakdown ? (\n                <div\n                  className=\"funnel-bar stacked\"\n                  style={{ width: `${widthPercent}%` }}\n                >\n                  <div\n                    className=\"bar-qr\"\n                    style={{ flex: step.breakdown.qr }}\n                  ></div>\n                  <div\n                    className=\"bar-direct\"\n                    style={{ flex: step.breakdown.direct }}\n                  ></div>\n                </div>\n              ) : (\n                <div\n                  className=\"funnel-bar single\"\n                  style={{\n                    width: `${widthPercent}%`,\n                    background: step.value > 6 ? \"#4caf50\" : step.value > 3 ? \"#fbc02d\" : \"#fb8c00\"\n                  }}\n                ></div>\n              )}\n            </div>\n\n            <div className=\"funnel-label\">\n              {step.label} â€” <strong>{step.value}</strong>\n              {step.breakdown && (\n                <span className=\"breakdown\">\n                  {\" \"}\n                  (QR: {step.breakdown.qr}, Direct: {step.breakdown.direct})\n                </span>\n              )}\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\n\nconst Stats = ({url}) => {\n    const [qrVisits, setQRVists] = useState(0);\n    const [directsVisits, setDirectsVisits] = useState(0);\n    const [dealsClaimed, setDealsClaimed] = useState(0);\n    const [repeatVisits, setRepeatVisits] = useState(0);\n    const [funnelData, setFunnelData] = useState(null);\n\n    const loadStats = async () => {\n        let storeId = JSON.parse(window.sessionStorage.getItem('user-profile')).storeId;\n        axios.get(`/store-stats/${storeId}`)\n            .then(function (response) {\n                if(response.data != 'auth error') {\n                    console.log('--res--', JSON.stringify(response.data));\n                    const result = response.data.reduce((acc, item) => {\n                        acc[item.metric] = Number(item.value); // convert string to number\n                        return acc;\n                      }, {});\n                      \n                    setFunnelData(result);\n                    setQRVists(result['QR_VISITS']);\n                    setDirectsVisits(result['DIRECT_VISITS']);\n                    setDealsClaimed(result['DEALS_CLAIMED']);\n                    setRepeatVisits(result['REPEAT_VISITS']);\n                }\n            }.bind(this));\n    }\n\n    useEffect(() => {\n        const tabs = document.getElementById('notif-tabs');\n        const tabElements = document.querySelectorAll('.notif-tab');\n\n        tabElements.forEach(tab => {\n            tab.addEventListener('click', () => {\n                tabElements.forEach(t => t.classList.remove('active'));\n                tab.classList.add('active');\n            });\n        });\n\n        loadStats();\n    }, []);\n\n    return (\n        <div className=\"main\">\n           <div class=\"container\">\n                <h1>Stats</h1>\n                <div class=\"notif-tabs-container\">\n                    <div class=\"notif-tabs\" id=\"notif-tabs\">\n                        <div class=\"notif-tab active\">Repeat</div>\n                        <div class=\"notif-tab\">Referral</div>\n                        <div class=\"notif-tab\">Online Orders</div>\n                    </div>\n                </div>\n\n                {funnelData != null && <Funnel data={funnelData} />}\n\n                <div className=\"festive\">\n                {qrVisits > 0 && \n                    <div className=\"notif-item\">\n                        {qrVisits}\n                    </div>\n                }\n                {directsVisits > 0 && \n                    <div className=\"notif-item\">\n                        {directsVisits}\n                    </div>\n                }\n                {dealsClaimed > 0 && \n                    <div className=\"notif-item\">\n                        {dealsClaimed}\n                    </div>\n                }\n                {repeatVisits > 0 && \n                    <div className=\"notif-item\">\n                        {repeatVisits}\n                    </div>\n                }\n                </div>\n                \n                \n            </div>\n\n        </div>\n    );\n}\n\nexport default Stats;\n"],"names":["Funnel","_ref","data","qr","QR_VISITS","direct","DIRECT_VISITS","funnelData","label","value","breakdown","DEALS_CLAIMED","REPEAT_VISITS","maxValue","Math","max","map","d","_jsx","className","children","step","idx","widthPercent","_jsxs","style","width","concat","flex","background","_ref2","url","qrVisits","setQRVists","useState","directsVisits","setDirectsVisits","dealsClaimed","setDealsClaimed","repeatVisits","setRepeatVisits","setFunnelData","useEffect","document","getElementById","tabElements","querySelectorAll","forEach","tab","addEventListener","t","classList","remove","add","async","storeId","JSON","parse","window","sessionStorage","getItem","axios","then","response","console","log","stringify","result","reduce","acc","item","metric","Number","bind","loadStats","class","id"],"sourceRoot":""}