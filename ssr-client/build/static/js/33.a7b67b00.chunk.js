"use strict";(self.webpackChunkssr_client=self.webpackChunkssr_client||[]).push([[33],{33:(e,r,t)=>{t.r(r),t.d(r,{default:()=>j});var s=t(643),o=t(214),n=t.n(o),a={message:"Missing file parameter for upload"},i={message:"Missing fileName parameter for upload"},l={message:"Missing public key for upload"},c={message:"Request to ImageKit upload endpoint failed due to network error"},u={message:"Missing signature for upload. The SDK expects token, signature and expire for authentication."},d={message:"Missing token for upload. The SDK expects token, signature and expire for authentication."},p={message:"Missing expire for upload. The SDK expects token, signature and expire for authentication."},g={message:"Invalid transformation parameter. Please include at least pre, post, or both."},f={message:"Invalid pre transformation parameter."},m={message:"Invalid post transformation parameter."};class h extends Error{constructor(e,r){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitInvalidRequestError",this.$ResponseMetadata=r}}class y extends Error{constructor(e,r){super(e),this.reason=void 0,this.name="ImageKitAbortError",this.reason=r}}class x extends Error{constructor(e){super(e),this.name="ImageKitUploadNetworkError"}}class b extends Error{constructor(e,r){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitServerError",this.$ResponseMetadata=r}}const v=(e,r)=>{let t={...e};const s=w(r);return Object.defineProperty(t,"$ResponseMetadata",{value:s,enumerable:!1,writable:!1}),t},w=e=>{const r=function(e){const r={},t=e.getAllResponseHeaders();Object.keys(t).length&&t.trim().split(/[\r\n]+/).map((e=>e.split(/: /))).forEach((e=>{r[e[0].trim().toLowerCase()]=e[1].trim()}));return r}(e);return{statusCode:e.status,headers:r,requestId:r["x-request-id"]}};"function"===typeof SuppressedError&&SuppressedError;(0,s.createContext)({});var S=t(507);const j=e=>{let{url:r}=e;const[t,o]=(0,s.useState)(""),[j,k]=(0,s.useState)(0),[E,P]=(0,s.useState)(0),q=(0,s.createRef)(),A=new AbortController;return(0,S.jsxs)("div",{className:"main",children:[(0,S.jsxs)("div",{class:"container",children:[(0,S.jsx)("h1",{children:"Add Product"}),(0,S.jsx)("input",{id:"pTitle",type:"text",placeholder:"Title"}),(0,S.jsx)("input",{id:"pHighlights",type:"text",placeholder:"Highlights (e.g. type: kidswear, age: 9-10)"}),(0,S.jsx)("textarea",{id:"pDesc",placeholder:"Description"}),(0,S.jsx)("input",{id:"pPrice",type:"number",placeholder:"Price"}),(0,S.jsxs)("select",{id:"pEligibleFor",children:[(0,S.jsx)("option",{disabled:!0,selected:!0,children:"Eligible for"}),(0,S.jsx)("option",{children:"Online Purchase"}),(0,S.jsx)("option",{children:"Online Enquiry"}),(0,S.jsx)("option",{children:"Online Booking"})]}),(0,S.jsxs)("select",{id:"pCategory",children:[(0,S.jsx)("option",{selected:!0,children:"Default"}),(0,S.jsx)("option",{children:"Season's Special"}),(0,S.jsx)("option",{children:"New Arrival"})]}),(0,S.jsx)("input",{type:"file",ref:q,style:{width:"92%"}}),(0,S.jsx)("div",{className:"footer-buttons",children:(0,S.jsx)("button",{style:{background:"linear-gradient(180deg, #595959, #000000)"},type:"button",onClick:async()=>{const e=q.current;if(!e||!e.files||0===e.files.length)return void alert("Please select a file to upload");const r=e.files[0];let t;try{t=await(async()=>{try{const e=await fetch("/auth");if(!e.ok){const r=await e.text();throw new Error("Request failed with status ".concat(e.status,": ").concat(r))}const r=await e.json(),{signature:t,expire:s,token:o,publicKey:n}=r;return{signature:t,expire:s,token:o,publicKey:n}}catch(e){throw console.error("Authentication error:",e),new Error("Authentication request failed")}})()}catch(E){return void console.error("Failed to authenticate for upload:",E)}const{signature:s,expire:o,token:n,publicKey:S}=t;try{const e=await(j={expire:o,token:n,signature:s,publicKey:S,file:r,fileName:r.name,onProgress:e=>{k(e.loaded/e.total*100)},abortSignal:A.signal},j?new Promise(((e,r)=>{const{xhr:t}=j||{};delete j.xhr;const s=t||new XMLHttpRequest;if(!j.file)return r(new h(a.message));if(!j.fileName)return r(new h(i.message));if(!j.publicKey||0===j.publicKey.length)return r(new h(l.message));if(!j.token)return r(new h(d.message));if(!j.signature)return r(new h(u.message));if(!j.expire)return r(new h(p.message));if(j.transformation){if(!Object.keys(j.transformation).includes("pre")&&!Object.keys(j.transformation).includes("post"))return r(new h(g.message));if(Object.keys(j.transformation).includes("pre")&&!j.transformation.pre)return r(new h(f.message));if(Object.keys(j.transformation).includes("post")){if(!Array.isArray(j.transformation.post))return r(new h(m.message));for(let e of j.transformation.post){if("abs"===e.type&&!e.protocol&&!e.value)return r(new h(m.message));if("transformation"===e.type&&!e.value)return r(new h(m.message))}}}var o=new FormData;let n;for(n in j)if(n)if("file"===n&&"string"!=typeof j.file)o.set("file",j.file,String(j.fileName));else if("tags"===n&&Array.isArray(j.tags))o.set("tags",j.tags.join(","));else if("signature"===n)o.set("signature",j.signature);else if("expire"===n)o.set("expire",String(j.expire));else if("token"===n)o.set("token",j.token);else if("responseFields"===n&&Array.isArray(j.responseFields))o.set("responseFields",j.responseFields.join(","));else if("extensions"===n&&Array.isArray(j.extensions))o.set("extensions",JSON.stringify(j.extensions));else if("customMetadata"!==n||"object"!==typeof j.customMetadata||Array.isArray(j.customMetadata)||null===j.customMetadata){if("transformation"===n&&"object"===typeof j.transformation&&null!==j.transformation)o.set(n,JSON.stringify(j.transformation));else if("checks"===n&&j.checks)o.set("checks",j.checks);else if(void 0!==j[n]){if(["onProgress","abortSignal"].includes(n))continue;o.set(n,String(j[n]))}}else o.set("customMetadata",JSON.stringify(j.customMetadata));function S(){var e;return s.abort(),r(new y("Upload aborted",null===(e=j.abortSignal)||void 0===e?void 0:e.reason))}if(j.onProgress&&(s.upload.onprogress=function(e){j.onProgress&&j.onProgress(e)}),j.abortSignal){var k;if(j.abortSignal.aborted)return r(new y("Upload aborted",null===(k=j.abortSignal)||void 0===k?void 0:k.reason));j.abortSignal.addEventListener("abort",S),s.addEventListener("loadend",(()=>{j.abortSignal&&j.abortSignal.removeEventListener("abort",S)}))}s.open("POST","https://upload.imagekit.io/api/v1/files/upload"),s.onerror=function(e){return r(new x(c.message))},s.onload=function(){if(s.status>=200&&s.status<300)try{var t=JSON.parse(s.responseText),o=v(t,s);return e(o)}catch(i){return r(i)}else if(s.status>=400&&s.status<500)try{var n;return t=JSON.parse(s.responseText),r(new h(null!==(n=t.message)&&void 0!==n?n:"Invalid request. Please check the parameters.",w(s)))}catch(i){return r(i)}else try{var a;return t=JSON.parse(s.responseText),r(new b(null!==(a=t.message)&&void 0!==a?a:"Server error occurred while uploading the file. This is rare and usually temporary.",w(s)))}catch(i){return r(new b("Server error occurred while uploading the file. This is rare and usually temporary.",w(s)))}},s.send(o)})):Promise.reject(new h("Invalid options provided for upload")));P(e.url),console.log("Upload response:",e)}catch(I){I instanceof y?console.error("Upload aborted:",I.reason):I instanceof h?console.error("Invalid request:",I.message):I instanceof x?console.error("Network error:",I.message):I instanceof b?console.error("Server error:",I.message):console.error("Upload error:",I)}var j},children:"Upload file"})}),(0,S.jsx)("br",{}),"Upload progress: ",(0,S.jsx)("progress",{value:j,max:100})]}),(0,S.jsxs)("div",{class:"footer-buttons",children:[(0,S.jsxs)("button",{onClick:()=>{(()=>{const e=document.querySelector("#pTitle").value,r=document.querySelector("#pHighlights").value,t=document.querySelector("#pDesc").value,s=document.querySelector("#pPrice").value,o=document.querySelector("#pEligibleFor").options[document.querySelector("#pEligibleFor").selectedIndex].value,a=document.querySelector("#pCategory").options[document.querySelector("#pCategory").selectedIndex].value,i=E,l=JSON.parse(window.sessionStorage.getItem("user-profile")).storeId;console.log("--title--",e),console.log("--highlights--",r),console.log("--description--",t),console.log("--price--",s),console.log("--eligibleFor--",o),console.log("--primaryCat--",a),console.log("--thumbnailUrl--",i),n().post("/createProduct",{title:e,highlights:r,description:t,price:s,eligibleFor:o,primaryCat:a,thumbnailUrl:i,storeId:l}).then((e=>{console.log("--Create Product Response--",e),setTimeout((()=>{window.location.reload()}),500)}))})()},children:[(0,S.jsx)("span",{children:"Save & Add"}),(0,S.jsx)("i",{class:"fas fa-plus"})]}),(0,S.jsxs)("button",{children:[(0,S.jsx)("span",{children:"Finish"}),(0,S.jsx)("i",{class:"fas fa-arrow-right"})]})]})]})}}}]);
//# sourceMappingURL=33.a7b67b00.chunk.js.map