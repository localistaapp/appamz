{"ast":null,"code":"import{useRef,useState}from\"react\";import{ImageKitAbortError,ImageKitInvalidRequestError,ImageKitServerError,ImageKitUploadNetworkError,upload}from\"@imagekit/react\";import\"./AddProducts.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AddProducts=_ref=>{let{url}=_ref;const[message,setMessage]=useState(\"\");// State to keep track of the current upload progress (percentage)\nconst[progress,setProgress]=useState(0);// Create a ref for the file input element to access its files easily\nconst fileInputRef=useRef<HTMLInputElement>null;// Create an AbortController instance to provide an option to cancel the upload if needed.\nconst abortController=new AbortController();const showMessage=msg=>{setMessage(msg);};const clearMessage=()=>{setMessage(\"\");};const authenticator=async()=>{try{// Perform the request to the upload authentication endpoint.\nconst response=await fetch(\"/auth\");if(!response.ok){// If the server response is not successful, extract the error text for debugging.\nconst errorText=await response.text();throw new Error(\"Request failed with status \".concat(response.status,\": \").concat(errorText));}// Parse and destructure the response JSON for upload credentials.\nconst data=await response.json();const{signature,expire,token,publicKey}=data;return{signature,expire,token,publicKey};}catch(error){// Log the original error for debugging before rethrowing a new error.\nconsole.error(\"Authentication error:\",error);throw new Error(\"Authentication request failed\");}};const handleUpload=async()=>{// Access the file input element using the ref\nconst fileInput=fileInputRef.current;if(!fileInput||!fileInput.files||fileInput.files.length===0){alert(\"Please select a file to upload\");return;}// Extract the first file from the file input\nconst file=fileInput.files[0];// Retrieve authentication parameters for the upload.\nlet authParams;try{authParams=await authenticator();}catch(authError){console.error(\"Failed to authenticate for upload:\",authError);return;}const{signature,expire,token,publicKey}=authParams;// Call the ImageKit SDK upload function with the required parameters and callbacks.\ntry{const uploadResponse=await upload({// Authentication parameters\nexpire,token,signature,publicKey,file,fileName:file.name,// Optionally set a custom file name\n// Progress callback to update upload progress state\nonProgress:event=>{setProgress(event.loaded/event.total*100);},// Abort signal to allow cancellation of the upload if needed.\nabortSignal:abortController.signal});console.log(\"Upload response:\",uploadResponse);}catch(error){// Handle specific error types provided by the ImageKit SDK.\nif(error instanceof ImageKitAbortError){console.error(\"Upload aborted:\",error.reason);}else if(error instanceof ImageKitInvalidRequestError){console.error(\"Invalid request:\",error.message);}else if(error instanceof ImageKitUploadNetworkError){console.error(\"Network error:\",error.message);}else if(error instanceof ImageKitServerError){console.error(\"Server error:\",error.message);}else{// Handle any other errors that may occur.\nconsole.error(\"Upload error:\",error);}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"main\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Add Product\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Highlights (e.g. type: kidswear, age: 9-10)\"}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Price\"}),/*#__PURE__*/_jsxs(\"select\",{children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,selected:true,children:\"Eligible for\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Online Purchase\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Online Enquiry\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Online Booking\"})]}),/*#__PURE__*/_jsxs(\"select\",{children:[/*#__PURE__*/_jsx(\"option\",{selected:true,children:\"Default\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Season's Special\"}),/*#__PURE__*/_jsx(\"option\",{children:\"New Arrival\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleUpload,children:\"Upload file\"}),/*#__PURE__*/_jsx(\"br\",{}),\"Upload progress: \",/*#__PURE__*/_jsx(\"progress\",{value:progress,max:100})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"footer-buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Save & Add\"}),/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-plus\"})]}),/*#__PURE__*/_jsxs(\"button\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Finish\"}),/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-arrow-right\"})]})]})]});};export default AddProducts;","map":{"version":3,"names":["useRef","useState","ImageKitAbortError","ImageKitInvalidRequestError","ImageKitServerError","ImageKitUploadNetworkError","upload","jsx","_jsx","jsxs","_jsxs","AddProducts","_ref","url","message","setMessage","progress","setProgress","fileInputRef","HTMLInputElement","abortController","AbortController","showMessage","msg","clearMessage","authenticator","response","fetch","ok","errorText","text","Error","concat","status","data","json","signature","expire","token","publicKey","error","console","handleUpload","fileInput","current","files","length","alert","file","authParams","authError","uploadResponse","fileName","name","onProgress","event","loaded","total","abortSignal","signal","log","reason","className","children","class","type","placeholder","disabled","selected","ref","onClick","value","max"],"sources":["/Users/srishti/Documents/code/appamz/ssr-client/src/store/mainview/addproducts/AddProducts.js"],"sourcesContent":["import { useRef, useState } from \"react\";\nimport {\n    ImageKitAbortError,\n    ImageKitInvalidRequestError,\n    ImageKitServerError,\n    ImageKitUploadNetworkError,\n    upload,\n} from \"@imagekit/react\";\nimport \"./AddProducts.css\";\n\nconst AddProducts = ({url}) => {\n    const [message, setMessage] = useState(\"\");\n\n    // State to keep track of the current upload progress (percentage)\n    const [progress, setProgress] = useState(0);\n\n    // Create a ref for the file input element to access its files easily\n    const fileInputRef = useRef<HTMLInputElement>(null);\n\n    // Create an AbortController instance to provide an option to cancel the upload if needed.\n    const abortController = new AbortController();\n\n    const showMessage = (msg) => {\n        setMessage(msg);\n    };\n\n    const clearMessage = () => {\n        setMessage(\"\");\n    };\n\n    const authenticator = async () => {\n        try {\n            // Perform the request to the upload authentication endpoint.\n            const response = await fetch(\"/auth\");\n            if (!response.ok) {\n                // If the server response is not successful, extract the error text for debugging.\n                const errorText = await response.text();\n                throw new Error(`Request failed with status ${response.status}: ${errorText}`);\n            }\n\n            // Parse and destructure the response JSON for upload credentials.\n            const data = await response.json();\n            const { signature, expire, token, publicKey } = data;\n            return { signature, expire, token, publicKey };\n        } catch (error) {\n            // Log the original error for debugging before rethrowing a new error.\n            console.error(\"Authentication error:\", error);\n            throw new Error(\"Authentication request failed\");\n        }\n    };\n\n    const handleUpload = async () => {\n        // Access the file input element using the ref\n        const fileInput = fileInputRef.current;\n        if (!fileInput || !fileInput.files || fileInput.files.length === 0) {\n            alert(\"Please select a file to upload\");\n            return;\n        }\n\n        // Extract the first file from the file input\n        const file = fileInput.files[0];\n\n        // Retrieve authentication parameters for the upload.\n        let authParams;\n        try {\n            authParams = await authenticator();\n        } catch (authError) {\n            console.error(\"Failed to authenticate for upload:\", authError);\n            return;\n        }\n        const { signature, expire, token, publicKey } = authParams;\n\n        // Call the ImageKit SDK upload function with the required parameters and callbacks.\n        try {\n            const uploadResponse = await upload({\n                // Authentication parameters\n                expire,\n                token,\n                signature,\n                publicKey,\n                file,\n                fileName: file.name, // Optionally set a custom file name\n                // Progress callback to update upload progress state\n                onProgress: (event) => {\n                    setProgress((event.loaded / event.total) * 100);\n                },\n                // Abort signal to allow cancellation of the upload if needed.\n                abortSignal: abortController.signal,\n            });\n            console.log(\"Upload response:\", uploadResponse);\n        } catch (error) {\n            // Handle specific error types provided by the ImageKit SDK.\n            if (error instanceof ImageKitAbortError) {\n                console.error(\"Upload aborted:\", error.reason);\n            } else if (error instanceof ImageKitInvalidRequestError) {\n                console.error(\"Invalid request:\", error.message);\n            } else if (error instanceof ImageKitUploadNetworkError) {\n                console.error(\"Network error:\", error.message);\n            } else if (error instanceof ImageKitServerError) {\n                console.error(\"Server error:\", error.message);\n            } else {\n                // Handle any other errors that may occur.\n                console.error(\"Upload error:\", error);\n            }\n        }\n    };\n\n\n    return (\n        <div className=\"main\">\n           <div class=\"container\">\n                <h1>Add Product</h1>\n                <input type=\"text\" placeholder=\"Title\" />\n                <input type=\"text\" placeholder=\"Highlights (e.g. type: kidswear, age: 9-10)\" />\n                <textarea placeholder=\"Description\"></textarea>\n                <input type=\"number\" placeholder=\"Price\" />\n                \n                <select>\n                <option disabled selected>Eligible for</option>\n                <option>Online Purchase</option>\n                <option>Online Enquiry</option>\n                <option>Online Booking</option>\n                </select>\n\n                <select>\n                <option selected>Default</option>\n                <option>Season's Special</option>\n                <option>New Arrival</option>\n                </select>\n\n                 {/* File input element using React ref */}\n                    <input type=\"file\" ref={fileInputRef} />\n                    {/* Button to trigger the upload process */}\n                    <button type=\"button\" onClick={handleUpload}>\n                        Upload file\n                    </button>\n                    <br />\n                    {/* Display the current upload progress */}\n                    Upload progress: <progress value={progress} max={100}></progress>\n            </div>\n\n            <div class=\"footer-buttons\">\n                <button><span>Save & Add</span><i class=\"fas fa-plus\"></i></button>\n                <button><span>Finish</span><i class=\"fas fa-arrow-right\"></i></button>\n            </div>\n        </div>\n    );\n}\n\nexport default AddProducts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}